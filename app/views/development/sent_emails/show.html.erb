<% content_for :title, h(@email[:subject]) %>

<div class="space-y-8">
  <div class="flex items-center justify-between">
    <h1 class="ff-h1 text-3xl" data-key="development.emails.subject"><%= h @email[:subject] %></h1>
    <%= link_to "Back to all emails",
                development_sent_emails_path,
                class: class_names("ff-button", "ff-button--secondary", "ff-button--compact") %>
  </div>

  <div class="ff-card">
    <div class="ff-card__body">
      <dl class="grid grid-cols-1 gap-4 text-sm text-slate-600 sm:grid-cols-4">
        <div class="space-y-1">
          <dt class="font-semibold uppercase tracking-wide text-slate-500">Message-ID</dt>
          <dd class="sm:col-span-3 w-full break-all rounded bg-slate-50 px-3 py-2 font-mono text-xs text-slate-700"><%= h @email[:message_id] %></dd>
        </div>

        <div class="space-y-1">
          <dt class="font-semibold uppercase tracking-wide text-slate-500">From</dt>
          <dd class="sm:col-span-3 w-full break-words rounded bg-slate-50 px-3 py-2 font-mono text-xs text-slate-700"><%= h @email[:from] %></dd>
        </div>

        <div class="space-y-1">
          <dt class="font-semibold uppercase tracking-wide text-slate-500">To</dt>
          <dd class="sm:col-span-3 w-full break-words rounded bg-slate-50 px-3 py-2 font-mono text-xs text-slate-700"><%= h @email[:to] %></dd>
        </div>

        <div class="space-y-1">
          <dt class="font-semibold uppercase tracking-wide text-slate-500">Date</dt>
          <dd class="sm:col-span-3 text-slate-700"><%= h @email[:date] %></dd>
        </div>
      </dl>
    </div>
  </div>

  <div class="ff-card">
    <div class="ff-card__body space-y-6">
      <% if @email[:multipart] %>
        <div data-controller="email-viewer" class="space-y-6">
          <div class="flex flex-wrap gap-2">
            <button type="button" data-action="email-viewer#showText" class="ff-button ff-button--compact" data-email-viewer-target="textButton" data-key="development.emails.tab.text">Text</button>
            <button type="button" data-action="email-viewer#showHtml" class="ff-button ff-button--secondary ff-button--compact" data-email-viewer-target="htmlButton" data-key="development.emails.tab.html">HTML</button>
          </div>
          <div class="rounded-lg border border-slate-200 bg-slate-50 p-4" data-email-viewer-target="textPanel">
            <pre class="mb-0 whitespace-pre-wrap text-sm text-slate-700" data-key="development.emails.text-part"><%= h @email[:text_part] %></pre>
          </div>
          <div class="hidden rounded-lg border border-slate-200 bg-white" data-email-viewer-target="htmlPanel">
            <iframe srcdoc="<%= ERB::Util.html_escape(@email[:html_part]) %>" sandbox title="Email HTML preview" referrerpolicy="no-referrer" class="h-[400px] w-full rounded-lg"></iframe>
          </div>
        </div>
      <% else %>
        <div class="rounded-lg border border-slate-200 bg-slate-50 p-4">
          <pre class="mb-0 whitespace-pre-wrap text-sm text-slate-700" data-key="development.emails.body"><%= h @email[:body] %></pre>
        </div>
      <% end %>
    </div>
  </div>
</div>
