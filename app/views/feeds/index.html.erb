<div class="row">
  <div class="col-12">
    <%= page_header "Feeds" do %>
      <%= link_to "New Feed", new_feed_path, class: "btn btn-primary" %>
    <% end %>

    <% if @feeds.any? %>
      <div class="table-responsive">
        <table class="table table-hover table-bordered">
          <thead>
            <tr>
              <th>
                <%= sortable_header(column: "name", title: "Name") %>
              </th>
              <th>
                <%= sortable_header(column: "status", title: "Status") %>
              </th>
              <th>
                <%= sortable_header(column: "target_group", title: "Target Group") %>
              </th>
              <th>
                <%= sortable_header(column: "last_refresh", title: "Last Refresh") %>
              </th>
              <th>
                <%= sortable_header(column: "recent_post", title: "Recent Post") %>
              </th>
            </tr>
          </thead>
          <tbody>
            <% @feeds.each do |feed| %>
              <tr>
                <td>
                  <%= link_to feed, class: "text-decoration-none" do %>
                    <%= feed.name %>
                  <% end %>
                </td>
                <td>
                  <% if feed.enabled? %>
                    <%= icon("check-circle-fill", css_class: "text-success me-1") %>
                  <% else %>
                    <%= icon("x-circle", css_class: "text-muted me-1") %>
                  <% end %>
                  <%= feed.state.capitalize %>
                </td>
                <td>
                  <% if feed.target_group.present? %>
                    <%= feed.target_group %>
                  <% else %>
                    <em class="text-muted">None</em>
                  <% end %>
                </td>
                <td>
                  <% if feed.last_refreshed_at %>
                    <%= short_time_ago(feed.last_refreshed_at) %>
                  <% else %>
                    <em class="text-muted">Never</em>
                  <% end %>
                </td>
                <td>
                  <% if feed.most_recent_post_date %>
                    <%= short_time_ago(feed.most_recent_post_date) %>
                  <% else %>
                    <em class="text-muted">None</em>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>

      <%= pagination_for @feeds,
                         collection_name: "feeds",
                         path_helper: ->(page) { feeds_path(page: page, sort: params[:sort], direction: params[:direction]) } %>
    <% else %>
      <div class="text-center py-5">
        <p>No feeds yet</p>
        <p class="text-muted">Create your first feed to start aggregating content.</p>
        <%= link_to "Create Feed", new_feed_path, class: "btn btn-primary" %>
      </div>
    <% end %>
  </div>
</div>
