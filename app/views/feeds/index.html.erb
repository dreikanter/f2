<div class="row">
  <div class="col-12">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1>Feeds</h1>
      <%= link_to "New Feed", new_feed_path, class: "btn btn-primary" %>
    </div>

    <% if @feeds.any? %>
      <div class="table-responsive">
        <table class="table table-hover table-bordered">
          <thead>
            <tr>
              <th>Name</th>
              <th>Status</th>
              <th>Target Group</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% @feeds.each do |feed| %>
              <tr>
                <td>
                  <%= link_to feed, class: "text-decoration-none" do %>
                    <%= feed.name %>
                  <% end %>
                </td>
                <td>
                  <% if feed.enabled? %>
                    <i class="bi bi-check-circle-fill text-success me-1"></i>
                  <% else %>
                    <i class="bi bi-x-circle-fill text-danger me-1"></i>
                  <% end %>
                  <%= feed.state.capitalize %>
                </td>
                <td>
                  <% if feed.target_group.present? %>
                    <%= feed.target_group %>
                  <% else %>
                    <em class="text-muted">None</em>
                  <% end %>
                </td>
                <td>
                  <% if feed.feed_profile.present? %>
                    <%= button_to "Preview", feed_previews_path,
                        params: { url: feed.url, feed_profile_id: feed.feed_profile.id, feed_id: feed.id },
                        method: :post,
                        class: "btn btn-sm btn-outline-info",
                        title: "Generate feed preview" %>
                  <% elsif feed.respond_to?(:loader) && feed.loader.present? %>
                    <span class="text-muted small" title="Create a feed profile to enable preview">
                      Preview unavailable
                    </span>
                  <% else %>
                    <span class="text-muted small">No configuration</span>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <div class="text-center py-5">
        <p>No feeds yet</p>
        <p class="text-muted">Create your first feed to start aggregating content.</p>
        <%= link_to "Create Feed", new_feed_path, class: "btn btn-primary" %>
      </div>
    <% end %>
  </div>
</div>
