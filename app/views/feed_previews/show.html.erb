<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="mb-0">Feed Preview</h1>
  <div class="d-flex gap-2">
    <% if @feed_preview.ready? %>
      <%= button_to "Refresh Preview", feed_preview_path(@feed_preview),
          method: :patch,
          class: "btn btn-outline-secondary",
          data: { confirm: "This will generate a new preview. Continue?" } %>
    <% end %>
    <%= link_to "Back to Feeds", feeds_path, class: "btn btn-outline-secondary" %>
  </div>
</div>

<div class="card mb-4">
  <div class="card-header">
    <h5 class="card-title mb-0">Preview Details</h5>
  </div>
  <div class="card-body">
    <p class="mb-0">
      <strong>URL:</strong>
      <a href="<%= @feed_preview.url %>" target="_blank" class="text-decoration-none">
        <%= @feed_preview.url %>
      </a>
      (<%= @feed_preview.feed_profile.name %>)
      <% if @feed_preview.ready? %>
        â€” <%= @feed_preview.posts_count %> posts found
      <% end %>
    </p>
  </div>
</div>

<div id="preview-status">
  <% if @feed_preview.ready? %>
    <%= render "feed_previews/completed_status", feed_preview: @feed_preview %>
  <% elsif @feed_preview.pending? || @feed_preview.processing? %>
    <%= render "feed_previews/processing_status", feed_preview: @feed_preview %>
  <% elsif @feed_preview.failed? %>
    <%= render "feed_previews/failed_status", feed_preview: @feed_preview %>
  <% end %>
</div>