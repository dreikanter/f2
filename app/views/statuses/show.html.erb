<% content_for :title, "Status" %>

<% if @user.total_feeds_count == 0 %>
  <%= page_header "Welcome to Feeder" %>

  <div class="row">
    <div class="col-12">
      <p>
        Feeder helps you automatically share content from your favorite sources to Freefeed.
      </p>
      <p>
        <strong>Getting started:</strong>
      </p>
      <ol class="mb-4">
        <li class="mb-2">
          First, grab a Freefeed access token from your account settings
        </li>
        <li class="mb-2">
          Add it here so Feeder can post on your behalf
        </li>
        <li class="mb-2">
          Then create your first feed â€” tell Feeder which content you want to share
        </li>
        <li>
          Sit back and let Feeder automatically post new items to your Freefeed timeline
        </li>
      </ol>
      <p>
        <%= link_to "Add Freefeed token", settings_access_tokens_path, class: "btn btn-primary me-2" %>
      </p>
    </div>
  </div>
<% else %>
  <%= page_header "Status" %>

  <div class="row">
    <div class="col-12">
      <div class="list-group">
        <div class="list-group-item">
          <strong>Total feeds:</strong>
          <%= number_with_delimiter(@user.total_feeds_count) %>
        </div>

        <% if @user.total_imported_posts_count > 0 %>
          <div class="list-group-item">
            <strong>Total imported posts:</strong>
            <%= number_with_delimiter(@user.total_imported_posts_count) %>
          </div>

          <div class="list-group-item">
            <strong>Total published posts:</strong>
            <%= number_with_delimiter(@user.total_published_posts_count) %>
          </div>
        <% end %>

        <% if @user.most_recent_post_published_at %>
          <div class="list-group-item">
            <strong>Most recent post publication:</strong>
            <%= time_ago_in_words(@user.most_recent_post_published_at) %> ago
          </div>
        <% end %>

        <% if @user.total_imported_posts_count > 0 %>
          <div class="list-group-item">
            <strong>Average posts per day (last week):</strong>
            <%= number_with_precision(@user.average_posts_per_day_last_week, precision: 1) %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
