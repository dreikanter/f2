<% content_for :title, "Change Email Address" %>

<%= page_header "Change Email Address" do %>
  <%= link_to "Back to Settings", settings_path, class: "btn btn-outline-secondary" %>
<% end %>

<div class="row">
  <div class="col-6">
    <% if @user.email_deactivated? %>
      <div class="alert alert-danger">
        <strong>Your email is deactivated.</strong>
        <% if @user.can_change_email? %>
          <p class="mb-0">Update your email address below to continue receiving notifications.</p>
        <% else %>
          <p class="mb-0">You can change your email again in <%= distance_of_time_in_words(@user.time_until_email_change_allowed) %>.</p>
        <% end %>
      </div>
    <% end %>

    <%= form_with model: @user, url: settings_email_update_path, method: :patch, local: true do |form| %>
      <div class="mb-3">
        <%= form.label :current_email, "Current email:", class: "form-label fw-bold" %>
        <%= form.text_field :current_email, value: @user.email_address, disabled: true, class: "form-control" %>
      </div>

      <div class="mb-3">
        <%= form.label :email_address, "New email:", class: "form-label fw-bold" %>
        <%= form.email_field :email_address, value: "", class: "form-control", placeholder: "Enter new email address", autofocus: true %>
      </div>

      <div class="mt-4">
        <%= form.submit "Update Email", class: "btn btn-primary me-2" %>
        <%= link_to "Cancel", settings_path, class: "btn btn-outline-secondary" %>
      </div>
    <% end %>
  </div>
</div>
