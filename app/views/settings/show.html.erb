<% content_for :title, "Settings" %>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>Settings</h1>
  <%= link_to "Sign Out", session_path, data: { turbo_method: :delete }, class: "btn btn-outline-secondary" %>
</div>

<div class="row">
  <div class="col-12">
    <div class="list-group">
      <div class="list-group-item d-flex justify-content-between align-items-center">
        <div>
          <strong>Email:</strong> <%= @user.email_address %>
        </div>
        <%= link_to "Change...", edit_settings_email_update_path, class: "btn btn-sm btn-outline-primary" %>
      </div>

      <div class="list-group-item d-flex justify-content-between align-items-center">
        <div>
          <strong>Password:</strong> last updated <%= time_ago_in_words(@user.password_updated_at || @user.created_at) %> ago
        </div>
        <%= link_to "Change...", edit_settings_password_update_path, class: "btn btn-sm btn-outline-primary" %>
      </div>

      <% if @user.permissions.any? %>
        <div class="list-group-item">
          <div class="mb-2">
            <strong>Permissions:</strong>
          </div>
          <ul class="mb-0">
            <% @user.permissions.each do |permission| %>
              <li><%= permission.name.humanize %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="list-group-item d-flex justify-content-between align-items-center">
        <div>
          <strong>Tokens:</strong>
          <% if @access_tokens.any? %>
            <%= pluralize(@access_tokens.active.count, 'active') %><% if @access_tokens.inactive.any? %>, <%= pluralize(@access_tokens.inactive.count, 'inactive') %><% end %>
          <% else %>
            none configured
          <% end %>
        </div>
        <%= link_to (@access_tokens.any? ? "Manage..." : "Add a token..."), (@access_tokens.any? ? settings_access_tokens_path : new_settings_access_token_path), class: "btn btn-sm btn-outline-primary" %>
      </div>
    </div>
  </div>
</div>
