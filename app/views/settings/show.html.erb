<% content_for :title, "Settings" %>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>Settings</h1>
  <%= link_to "Sign Out", session_path, data: { turbo_method: :delete }, class: "btn btn-outline-secondary" %>
</div>

<div class="row">
  <div class="col-12">
    <div class="list-group">
      <div class="list-group-item">
        <strong>Email:</strong> <%= @user.email_address %>
        <%= link_to "Change", edit_settings_email_update_path, class: "text-decoration-none ms-2" %>
      </div>

      <div class="list-group-item">
        <strong>Password:</strong> last updated <%= time_ago_in_words(@user.password_updated_at || @user.created_at) %> ago
        <%= link_to "Change", edit_settings_password_update_path, class: "text-decoration-none ms-2" %>
      </div>

      <% if @user.permissions.any? %>
        <div class="list-group-item">
          <div class="mb-2">
            <strong>Permissions:</strong>
          </div>
          <ul class="mb-0">
            <% @user.permissions.each do |permission| %>
              <li><%= permission.name.humanize %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="list-group-item">
        <strong>Tokens:</strong>
        <% if @access_tokens.any? %>
          <%= pluralize(@access_tokens.active.count, 'active') %><% if @access_tokens.inactive.any? %>, <%= pluralize(@access_tokens.inactive.count, 'inactive') %><% end %>
          <%= link_to "Manage", settings_access_tokens_path, class: "text-decoration-none ms-2" %>
        <% else %>
          none configured
          <%= link_to "Add a token", new_settings_access_token_path, class: "text-decoration-none ms-2" %>
        <% end %>
      </div>
    </div>
  </div>
</div>
