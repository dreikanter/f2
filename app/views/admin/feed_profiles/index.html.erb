<h1>Feed Profiles</h1>

<div class="d-flex justify-content-between align-items-center mb-4">
  <p class="text-muted mb-0">Manage feed processing configurations</p>
  <% if policy(FeedProfile).create? %>
    <%= link_to "New Feed Profile", new_admin_feed_profile_path, class: "btn btn-primary" %>
  <% end %>
</div>

<% if @feed_profiles.any? %>
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Name</th>
          <th>Loader</th>
          <th>Processor</th>
          <th>Normalizer</th>
          <th>Created By</th>
          <th>Feeds Count</th>
          <th class="text-end">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @feed_profiles.each do |profile| %>
          <tr>
            <td><%= link_to profile.name, admin_feed_profile_path(profile), class: "fw-bold" %></td>
            <td><span class="badge bg-secondary"><%= profile.loader %></span></td>
            <td><span class="badge bg-secondary"><%= profile.processor %></span></td>
            <td><span class="badge bg-secondary"><%= profile.normalizer %></span></td>
            <td><%= profile.user.email_address %></td>
            <td><%= profile.feeds.count %></td>
            <td class="text-end">
              <% if policy(profile).update? %>
                <%= link_to "Edit", edit_admin_feed_profile_path(profile), class: "btn btn-sm btn-outline-primary" %>
              <% end %>
              <% if policy(profile).destroy? %>
                <%= link_to "Delete", admin_feed_profile_path(profile), method: :delete,
                            confirm: "Are you sure? This will deactivate #{profile.feeds.count} feeds.",
                            class: "btn btn-sm btn-outline-danger" %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <div class="text-center py-5">
    <p class="text-muted">No feed profiles found.</p>
    <% if policy(FeedProfile).create? %>
      <%= link_to "Create the first feed profile", new_admin_feed_profile_path, class: "btn btn-primary" %>
    <% end %>
  </div>
<% end %>