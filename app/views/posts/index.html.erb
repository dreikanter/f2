<div class="row">
  <div class="col-12">
    <%= page_header "Posts" %>

    <% if @posts.any? %>
      <div class="table-responsive">
        <table class="table table-hover table-bordered posts-table">
          <thead>
            <tr>
              <th class="content-column">Content</th>
              <th class="feed-column">Feed</th>
              <th class="published-column text-center"><i class="bi bi-calendar3"></i></th>
              <th class="count-column text-center"><i class="bi bi-paperclip"></i></th>
              <th class="count-column text-center"><i class="bi bi-chat-dots"></i></th>
              <th class="status-column">Status</th>
              <th class="source-column">Source</th>
              <th class="freefeed-column">FreeFeed</th>
            </tr>
          </thead>
          <tbody>
            <% @posts.each do |post| %>
              <tr>
                <td class="content-column">
                  <%= link_to post, class: "text-decoration-none" do %>
                    <%= post_content_preview(post.content) %>
                  <% end %>
                </td>
                <td class="feed-column">
                  <%= link_to post.feed, class: "text-decoration-none" do %>
                    <%= post.feed.name %>
                  <% end %>
                </td>
                <td class="text-center">
                  <small class="text-muted">
                    <%= short_time_ago(post.published_at) if post.published_at %>
                  </small>
                </td>
                <td class="text-center">
                  <% if post.attachment_urls.present? %>
                    <%= post.attachment_urls.length %>
                  <% else %>
                    <span class="text-muted">0</span>
                  <% end %>
                </td>
                <td class="text-center">
                  <% if post.comments.present? %>
                    <%= post.comments.length %>
                  <% else %>
                    <span class="text-muted">0</span>
                  <% end %>
                </td>
                <td>
                  <%= post.status.capitalize %>
                </td>
                <td class="source-column">
                  <% if post.source_url.present? %>
                    <%= link_to "Src", post.source_url,
                                target: "_blank",
                                rel: "noopener",
                                title: "View original source" %>
                  <% else %>
                    <span class="text-light">—</span>
                  <% end %>
                </td>
                <td class="freefeed-column">
                  <% if post.freefeed_post_id.present? %>
                    <%= link_to "FF", "https://freefeed.net/#{post.feed.target_group}/#{post.freefeed_post_id}",
                                target: "_blank",
                                rel: "noopener",
                                title: "View on FreeFeed" %>
                  <% else %>
                    <span class="text-light">—</span>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>

      <%= pagination_for @posts,
                         collection_name: "posts",
                         path_helper: ->(page) { posts_path(page: page) } %>
    <% else %>
      <div class="text-center py-5">
        <p>No posts yet</p>
        <p class="text-muted">Posts will appear here when feeds are imported.</p>
        <%= link_to "View Feeds", feeds_path, class: "btn btn-primary" %>
      </div>
    <% end %>
  </div>
</div>