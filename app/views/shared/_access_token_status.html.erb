<%-

  access_token = local_assigns.fetch(:access_token)
  error = local_assigns[:error]

-%>

<% if access_token.pending? %>
  <div id="<%= dom_id(access_token, :status) %>" data-status="<%= access_token.status %>">
    <div class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></div>
    New
  </div>
<% elsif access_token.validating? %>
  <div id="<%= dom_id(access_token, :status) %>" data-status="<%= access_token.status %>" data-controller="polling" data-polling-endpoint-value="<%= settings_access_token_validation_path(access_token) %>" data-debug-id="<%= access_token.id %>">
    <div class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></div>
    ⏳ Validating...
  </div>
<% elsif access_token.active? %>
  <div id="<%= dom_id(access_token, :status) %>">
    <span class="text-success"><i class="bi bi-check-circle-fill"></i> Active</span>
  </div>
<% elsif access_token.inactive? %>
  <div id="<%= dom_id(access_token, :status) %>">
    <span class="text-muted"><i class="bi bi-x-circle"></i> Inactive</span>
    <% if error %>
      <br><small class="text-muted"><%= error %></small>
    <% end %>
  </div>
<% end %>
